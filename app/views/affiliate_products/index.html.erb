<% content_for :title, "@piertutor | Prodotti Affiliati" %>
<% content_for :meta_description, "Prodotti affiliati consigliati da Piertutor" %>

<%# BANNER %>
<div class="relative h-64 md:h-128 w-full">
  <!-- Background Image -->
  <div class="absolute inset-0 bg-cover md:bg-fixed bg-bottom" style="background-image: url(<%= asset_path('driving.webp') %>);"></div>

  <!-- Dark Overlay -->
  <div class="absolute inset-0 bg-black opacity-60"></div>

  <!-- Content -->
  <div class="relative flex flex-col justify-end items-center h-full text-center text-white p-8 gap-4">
    <h1 class="text-4xl md:text-6xl font-bold max-w-3xl">Prodotti Affiliati</h1>
    <% if current_user %>
      <div class="w-full max-w-64 mx-auto">
        <%= link_to "Aggiungi Prodotto", new_affiliate_product_path, class: "btn btn-outline btn-primary-content w-full" %>
      </div>
    <% end %>
  </div>
</div>

<%# PRODUCT LIST %>
<section class="bg-gray-100 py-16 px-8">
  <div class="max-w-[1200px] mx-auto">
    <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
      <% @affiliate_products.each do |affiliate_product| %>
        <div class="bg-white flex flex-col border border-gray-200 overflow-hidden">
          <!-- Image -->
          <div class="w-full flex items-center justify-center p-4">
            <img src="<%= affiliate_product.image_url %>" 
                 alt="<%= affiliate_product.title %>"
                 class="w-full h-64 object-contain"/>
          </div>

          <!-- Content -->
          <div class="flex flex-col flex-grow p-6">
            <h2 class="text-lg font-semibold mb-4 text-gray-900"><%= affiliate_product.title %></h2>
            
            <div class="mt-auto flex flex-col gap-3">
              <a href="<%= affiliate_product.affiliate_url %>" target="_blank" rel="nofollow" 
                 class="translate-x-[2px] w-full px-4 py-2 bg-brand text-black font-semibold text-center border border-black shadow-[-4px_4px_0_0_#000] transition-all duration-150 
                        hover:translate-x-[-4px] hover:translate-y-[4px] hover:shadow-none cursor-pointer 
                        active:translate-x-[-4px] active:translate-y-[4px] active:shadow-none">
                Guarda su Amazon
              </a>

              <% if current_user %>
                <%= link_to 'Elimina', affiliate_product_path(affiliate_product),
                  data: { turbo_method: :delete, turbo_confirm: 'Sicuro?' },
                  class: "translate-x-[2px] w-full px-4 py-2 bg-red-600 text-white font-semibold text-center border border-black shadow-[-4px_4px_0_0_#000] transition-all duration-150 
                          hover:translate-x-[-4px] hover:translate-y-[4px] hover:shadow-none cursor-pointer 
                          active:translate-x-[-4px] active:translate-y-[4px] active:shadow-none" %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</section>
