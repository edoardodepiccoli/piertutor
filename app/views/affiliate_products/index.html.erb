<% content_for :title, "@piertutor | Prodotti Affiliati" %>
<% content_for :meta_description, "Prodotti affiliati consigliati da Piertutor" %>

<%# BANNER %>
<div class="relative h-64 md:h-128 w-full">
  <!-- Background Image -->
  <div class="absolute inset-0 bg-cover md:bg-fixed bg-bottom" style="background-image: url(<%= asset_path('driving.webp') %>);"></div>

  <!-- Dark Overlay -->
  <div class="absolute inset-0 bg-black opacity-60"></div>

  <!-- Content -->
  <div class="relative flex flex-col justify-end items-center h-full text-center text-white p-8 gap-4">
    <h1 class="text-4xl md:text-6xl font-bold max-w-3xl">Prodotti Affiliati</h1>
    <% if current_user %>
      <div class="w-full max-w-64 mx-auto">
        <%= link_to "Aggiungi Prodotto", new_affiliate_product_path, class: "btn btn-outline btn-primary-content w-full" %>
      </div>
    <% end %>
  </div>
</div>

<%# HIGHLIGHTED PRODUCTS %>
<% if @highlighted_products.any? %>
  <section class="bg-brand py-16 px-8">
    <div class="max-w-[1200px] mx-auto">
      <h2 class="text-3xl font-bold text-black mb-8 text-center">In Evidenza</h2>
      <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
        <% @highlighted_products.each do |affiliate_product| %>
          <%= render partial: 'product_card', locals: { affiliate_product: affiliate_product, highlighted: true } %>
        <% end %>
      </div>
    </div>
  </section>
<% end %>

<%# REGULAR PRODUCT LIST %>
<section class="bg-gray-100 py-16 px-8">
  <div class="max-w-[1200px] mx-auto">
    <% if @highlighted_products.any? %>
      <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">Altri Prodotti</h2>
    <% end %>
    <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
      <% @regular_products.each do |affiliate_product| %>
        <%= render partial: 'product_card', locals: { affiliate_product: affiliate_product, highlighted: false } %>
      <% end %>
    </div>
  </div>
</section>
